sap.ui.define(["sap/m/MessageToast","sap/ui/core/mvc/Controller","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/FilterType","sap/ui/model/Sorter","sap/ui/core/util/Export","sap/ui/core/util/ExportTypeCSV","sap/m/MessageBox","sap/ui/core/util/MockServer","sap/ui/export/Spreadsheet","sap/ui/model/odata/v2/ODataModel","sap/ui/model/json/JSONModel","sap/ui/core/util/Export","sap/ui/core/util/ExportTypeCSV"],function(t,e,a,o,n,r,i,s,l,d,_,M,p,O,u){"use strict";var c={BotList:[]};var S={items:[]};return e.extend("MM.mat_consumption.controller.Home",{onInit:function(){var t=this},_getMatStock:function(t,e,a){var o=this.getView().byId("idFieldPlant").getValue().toUpperCase();var n=this.getOwnerComponent().getModel("MATSTOCK");var r={MatStock:[]};var i=new sap.ui.model.Filter("Plant",sap.ui.model.FilterOperator.EQ,o);var s=new sap.ui.model.Filter({filters:[i],and:true});var l=new Array(new sap.ui.model.Filter({filters:[s],and:true}));n.read("/YY1_MatStock",{urlParameters:{$select:"Material, Plant, CreationDate, CrossPlantStatusValidityDate, MatlCnsmpnQtyInMatlBaseUnit, MaterialBaseUnit, ProductDescription, CrossPlantStatus, On_Hand_Qty"},filters:[l],success:function(t,a){var o=t.results;o.sort();var n=o.length;if(n!==0){sap.m.MessageToast.show("Getting Material stock!!! ");for(var i=0;i<n;i++){if(o[i].Material!==""&&o[i].Plant!==""){if(o[i].CrossPlantStatusValidityDate===null){o[i].CrossPlantStatusValidityDate=o[i].CreationDate}r.MatStock.push({Material:o[i].Material,Plant:o[i].Plant,CreationDate:o[i].CrossPlantStatusValidityDate,MaterialBaseUnit:o[i].MaterialBaseUnit,MatlCnsmpnQtyInMatlBaseUnit:o[i].MatlCnsmpnQtyInMatlBaseUnit,On_Hand_Qty:o[i].On_Hand_Qty,SLoc_S099_Qty:o[i].on_hnd_s099,ProductDescription:o[i].ProductDescription,CrossPlantStatus:o[i].CrossPlantStatus})}}}e(r.MatStock)},error:function(){a()}})},_getStd_Price:function(t,e,a){var o=this.getView().byId("idFieldPlant").getValue().toUpperCase();var n=this.getOwnerComponent().getModel("STDPRICE");var r={StdPrice:[]};var i=new sap.ui.model.Filter("ValuationArea",sap.ui.model.FilterOperator.EQ,o);var s=new sap.ui.model.Filter({filters:[i],and:true});var l=new Array(new sap.ui.model.Filter({filters:[s],and:true}));n.read("/YY1_Prod_Std_Price",{urlParameters:{$select:"Product, ValuationArea, Std_Price"},filters:[l],success:function(t,a){var o=t.results;o.sort();var n=o.length;if(n!==0){sap.m.MessageToast.show("Getting standard price!!! ");for(var i=0;i<n;i++){if(o[i].Material!==""&&o[i].ValuationArea!==""){r.StdPrice.push({Material:o[i].Product,Std_Price:o[i].Std_Price,ValuationArea:o[i].ValuationArea})}}}e(r.StdPrice)},error:function(){a()}})},_getGoods_Mvnt:function(t,e,a){var o=this.getView().byId("idFieldPlant").getValue().toUpperCase();var n=this.getOwnerComponent().getModel("GOODSMVNT");var r={GOODS_MVMT:[]};var i=new sap.ui.model.Filter("Plant",sap.ui.model.FilterOperator.EQ,o);var s=new sap.ui.model.Filter({filters:[i],and:true});var l=this.getView().byId("idDatePicker").getValue().toUpperCase();var d=l.slice(6,10);var _=l.slice(0,2);var M=l.slice(3,5);var l=d+"-"+_+"-"+M;var p=new Date(l);var d=d-2;var O=d+"-"+_+"-"+M;var O=new Date(O);var u=new sap.ui.model.Filter("PostingDate",sap.ui.model.FilterOperator.LE,p.toISOString());var c=new sap.ui.model.Filter({filters:[u],and:true});var S=new sap.ui.model.Filter("PostingDate",sap.ui.model.FilterOperator.GE,O.toISOString());var v=new sap.ui.model.Filter({filters:[S],and:true});var m=new Array(new sap.ui.model.Filter({filters:[s,c,v],and:true}));n.read("/YY1_GOODS_MVMT",{urlParameters:{$select:"Material, Plant, MaterialBaseUnit, DocumentDate, TotalGdsMvtQtyInBaseUnit, CreationDate, GoodsMovementType"},filters:[m],success:function(t,a){var o=t.results;o.sort();var n=o.length;if(n!==0){sap.m.MessageToast.show("Getting goods movement data!!! ");for(var i=0;i<n;i++){if(o[i].Material!==""&&o[i].Plant!==""&&(o[i].GoodsMovementType==="261"||o[i].GoodsMovementType==="262"||o[i].GoodsMovementType==="602"||o[i].GoodsMovementType==="601")){r.GOODS_MVMT.push({Material:o[i].Material,Plant:o[i].Plant,MaterialBaseUnit:o[i].MaterialBaseUnit,DocumentDate:o[i].PostingDate,TotalGdsMvtQtyInBaseUnit:o[i].TotalGdsMvtQtyInBaseUnit,CreationDate:o[i].CreationDate,GoodsMovementType:o[i].GoodsMovementType})}}}e(r.GOODS_MVMT)},error:function(){a()}})},_getGoods_MvntQty:function(t,e,a){var o=this.getOwnerComponent().getModel("GOODSMVNT");var n={Goods_MvntQty:[]};var r=this.getView().byId("idFieldPlant").getValue().toUpperCase();var i=new sap.ui.model.Filter("Plant",sap.ui.model.FilterOperator.EQ,r);var s=new sap.ui.model.Filter({filters:[i],and:true});var l=this.getView().byId("idDatePicker").getValue().toUpperCase();var d=l.slice(6,10);var _=l.slice(0,2);var M=l.slice(3,5);var l=d+"-"+_+"-"+M;var p=new Date(l);var d=d-2;var O=d+"-"+_+"-"+M;var O=new Date(O);var u=new sap.ui.model.Filter("PostingDate",sap.ui.model.FilterOperator.LE,p.toISOString());var c=new sap.ui.model.Filter({filters:[u],and:true});var S=new sap.ui.model.Filter("PostingDate",sap.ui.model.FilterOperator.GE,O.toISOString());var v=new sap.ui.model.Filter({filters:[S],and:true});var m=new Array(new sap.ui.model.Filter({filters:[s,c,v],and:true}));o.read("/YY1_GOODS_MVMT",{urlParameters:{$select:"Material, Plant, TotalGdsMvtQtyInBaseUnit, CreationDate, GoodsMovementType"},filters:[m],success:function(t,a){var o=t.results;o.sort();var r=o.length;if(r!==0){sap.m.MessageToast.show("Getting goods movement data!!! ");for(var i=0;i<r;i++){if(o[i].Material!==""&&o[i].Plant!==""&&(o[i].GoodsMovementType==="261"||o[i].GoodsMovementType==="262"||o[i].GoodsMovementType==="602"||o[i].GoodsMovementType==="601")){n.Goods_MvntQty.push({Material:o[i].Material,Plant:o[i].Plant,TotalGdsMvtQtyInBaseUnit:o[i].TotalGdsMvtQtyInBaseUnit,CreationDate:o[i].CreationDate,GoodsMovementType:o[i].GoodsMovementType})}}}e(n.Goods_MvntQty)},error:function(){a()}})},_getQOH:function(t,e,a){if(this!==undefined){var o=this.getView().byId("idFieldPlant").getValue().toUpperCase();var n=new sap.ui.model.Filter("Plant",sap.ui.model.FilterOperator.EQ,o);var r=new sap.ui.model.Filter({filters:[n],and:true});var i=this.getView().byId("idDatePicker").getValue().toUpperCase();var s=i.slice(6,10);var l=i.slice(0,2);var d=i.slice(3,5);var i=s+"-"+l+"-"+d;var _=new Date(i);var s=s-2;var M=s+"-"+l+"-"+d;var M=new Date(M);var p=new sap.ui.model.Filter("MatlDocLatestPostgDate",sap.ui.model.FilterOperator.LE,_.toISOString());var O=new sap.ui.model.Filter({filters:[p],and:true});var u=new Array(new sap.ui.model.Filter({filters:[r,O],and:true}));var c={QOH:[]};var v=this.getOwnerComponent().getModel("STOCKONHND");v.read("/YY1_Material_in_Stock",{urlParameters:{$select:"Material, Plant, MatlWrhsStkQtyInMatlBaseUnit"},filters:[u],success:function(t,e){var a=t.results;a.sort();var o=a.length;if(o!==0){sap.m.MessageToast.show("Getting quantity on hand data!!! ");for(var n=0;n<o;n++){if(a[n].Material!==""&&a[n].Plant!==""){c.QOH.push({Material:a[n].Material,Plant:a[n].Plant,On_Hand_Qty:a[n].MatlWrhsStkQtyInMatlBaseUnit})}}}S.items=c.QOH},error:function(){}})}},_getSL099_QUANTITY:function(t,e,a){if(this!==undefined){var o=this.getView().byId("idFieldPlant").getValue().toUpperCase();var n=new sap.ui.model.Filter("Plant",sap.ui.model.FilterOperator.EQ,o);var r=new sap.ui.model.Filter({filters:[n],and:true});var i=this.getView().byId("idDatePicker").getValue().toUpperCase();var s=i.slice(6,10);var l=i.slice(0,2);var d=i.slice(3,5);var i=s+"-"+l+"-"+d;var _=new Date(i);var s=s-2;var M=s+"-"+l+"-"+d;var M=new Date(M);var p=new sap.ui.model.Filter("MatlDocLatestPostgDate",sap.ui.model.FilterOperator.LE,_.toISOString());var O=new sap.ui.model.Filter({filters:[p],and:true});var u="S099";var c=new sap.ui.model.Filter("StorageLocation",sap.ui.model.FilterOperator.EQ,u);var S=new sap.ui.model.Filter({filters:[c],and:true});var v=new Array(new sap.ui.model.Filter({filters:[r,O,S],and:true}));var m={SL099_QUANTITY:[]};var C=this.getOwnerComponent().getModel("STOCKONHND");C.read("/YY1_Material_in_Stock",{urlParameters:{$select:"Material, Plant, MatlWrhsStkQtyInMatlBaseUnit"},filters:[v],success:function(t,a){var o=t.results;o.sort();var n=o.length;if(n!==0){sap.m.MessageToast.show("Getting quantity on hand data!!! ");for(var r=0;r<n;r++){if(o[r].Material!==""&&o[r].Plant!==""){m.SL099_QUANTITY.push({Material:o[r].Material,Plant:o[r].Plant,On_Hand_Qty:o[r].MatlWrhsStkQtyInMatlBaseUnit})}}}e(m.SL099_QUANTITY)},error:function(){}})}},_buildFinalData:function(t){var e=0;var a={};var o=[];var n=0;var r=t;for(var i=0;i<r.StdPrice.length;i++){for(var s=0;s<r.MatStock.length;s++){if(r.MatStock[s].Material===r.StdPrice[i].Material&&r.MatStock[s].Plant===r.StdPrice[i].ValuationArea){for(var l=0;l<r.SL099_QUANTITY.length;l++){if(r.MatStock[s].Material===r.SL099_QUANTITY[l].Material){a.SLoc_S099_Qty=parseFloat(r.SL099_QUANTITY[l].On_Hand_Qty);break}}for(var d=0;d<S.items.length;d++){if(r.MatStock[s].Material===S.items[d].Material&&r.MatStock[s].Plant===S.items[d].Plant){r.MatStock[s].On_Hand_Qty=S.items[d].On_Hand_Qty;break}}var _=this.getView().byId("idDatePicker").getValue().toUpperCase();var M=this.getView().byId("idDatePicker").getValue().toUpperCase();var p=M.slice(6,10);var O=M.slice(0,2);var u=p;var v=O;var m="0000";var C="00";v=parseFloat(v);if(r.MatStock[s].CreationDate===null){}else{var m=r.MatStock[s].CreationDate.getFullYear()}if(r.MatStock[s].CreationDate===null){}else{var C=r.MatStock[s].CreationDate.getMonth()}e=(u-m)*12+(v-C);a.Material=r.MatStock[s].Material;a.ProductDescription=r.MatStock[s].ProductDescription;a.Plant=r.MatStock[s].Plant;a.CrossPlantStatus=r.MatStock[s].CrossPlantStatus;a.On_Hand_Qty=parseFloat(n)+parseFloat(r.MatStock[s].On_Hand_Qty);a.Tot_Std_Cost=parseFloat(r.MatStock[s].On_Hand_Qty)*parseFloat(r.StdPrice[i].Std_Price);a.Tot_Std_Cost=parseFloat(a.Tot_Std_Cost).toFixed(2);a.Std_Price=parseFloat(r.StdPrice[i].Std_Price).toFixed(2);if(a.CreationDate===null||a.CreationDate===undefined){a.CreationDate=r.MatStock[s].CreationDate.toISOString().slice(0,10);var p=a.CreationDate.slice(0,4);var O=a.CreationDate.slice(5,7);var f=a.CreationDate.slice(8,10);a.CreationDate=O+"/"+f+"/"+p}a.Consumption=0;a.Consumption261=0;a.Consumption262=0;a.GoodsShipped=0;a.GoodsShipped601=0;a.GoodsShipped602=0;a.ExcessQOH="0";for(var F=0;F<r.GOODS_MVMT_CUM.length;F++){if(r.MatStock[s].Material===r.GOODS_MVMT_CUM[F].Material&&r.MatStock[s].Plant===r.GOODS_MVMT_CUM[F].Plant){a.GoodsShipped=0;a.GoodsShipped601=0;a.GoodsShipped602=0;if((r.GOODS_MVMT_CUM[F].Plant==="US01"||r.GOODS_MVMT_CUM[F].Plant==="US02"||r.GOODS_MVMT_CUM[F].Plant==="US03")&&r.GOODS_MVMT_CUM[F].GoodsMovementType==="601"||r.GOODS_MVMT_CUM[F].GoodsMovementType==="602"){for(var P=0;P<r.GOODS_MVMT_CUM.length;P++){if(r.GOODS_MVMT_CUM[P].Material===r.GOODS_MVMT_CUM[F].Material&&r.GOODS_MVMT_CUM[P].Plant===r.GOODS_MVMT_CUM[F].Plant&&r.GOODS_MVMT_CUM[P].GoodsMovementType==="601"){a.GoodsShipped601=parseFloat(r.GOODS_MVMT_CUM[P].TotalGdsMvtQtyInBaseUnit)}if(r.GOODS_MVMT_CUM[P].Material===r.GOODS_MVMT_CUM[F].Material&&r.GOODS_MVMT_CUM[P].Plant===r.GOODS_MVMT_CUM[F].Plant&&r.GOODS_MVMT_CUM[P].GoodsMovementType==="602"){a.GoodsShipped602=parseFloat(r.GOODS_MVMT_CUM[P].TotalGdsMvtQtyInBaseUnit)}}}a.Consumption=0;a.Consumption261=0;a.Consumption262=0;if((r.GOODS_MVMT_CUM[F].Plant==="US01"||r.GOODS_MVMT_CUM[F].Plant==="US02"||r.GOODS_MVMT_CUM[F].Plant==="US03")&&r.GOODS_MVMT_CUM[F].GoodsMovementType==="261"||r.GOODS_MVMT_CUM[F].GoodsMovementType==="262"){for(var P=0;P<r.GOODS_MVMT_CUM.length;P++){if(r.GOODS_MVMT_CUM[P].Material===r.GOODS_MVMT_CUM[F].Material&&r.GOODS_MVMT_CUM[P].Plant===r.GOODS_MVMT_CUM[F].Plant&&r.GOODS_MVMT_CUM[P].GoodsMovementType==="261"){a.Consumption261=parseFloat(r.GOODS_MVMT_CUM[P].TotalGdsMvtQtyInBaseUnit)}if(r.GOODS_MVMT_CUM[P].Material===r.GOODS_MVMT_CUM[F].Material&&r.GOODS_MVMT_CUM[P].Plant===r.GOODS_MVMT_CUM[F].Plant&&r.GOODS_MVMT_CUM[P].GoodsMovementType==="262"){a.Consumption262=parseFloat(r.GOODS_MVMT_CUM[P].TotalGdsMvtQtyInBaseUnit)}}}}}if(a.GoodsShipped601==="undefined"){a.GoodsShipped601=0}if(a.GoodsShipped602==="undefined"){a.GoodsShipped602=0}if(a.Consumption261==="undefined"){a.Consumption261=0}if(a.Consumption262==="undefined"){a.Consumption262=0}a.Consumption=parseFloat(a.Consumption261)+parseFloat(a.Consumption262);a.GoodsShipped=parseFloat(a.GoodsShipped601)+parseFloat(a.GoodsShipped602);if(e<=24){a.MonthUsage24=parseFloat(a.Consumption)+parseFloat(a.GoodsShipped);a.MonthUsage24=parseFloat(a.MonthUsage24)/parseFloat(e)*24;a.MonthUsage24=parseFloat(a.MonthUsage24).toFixed(2)}else{a.MonthUsage24=parseFloat(a.Consumption)+parseFloat(a.GoodsShipped)}if(a.CrossPlantStatus==="05"){a.ExcessQOH=parseFloat(a.On_Hand_Qty).toFixed(2)}if(a.CrossPlantStatus==="03"){if(a.On_Hand_Qty>a.MonthUsage24){var D=parseFloat(a.On_Hand_Qty)-parseFloat(a.MonthUsage24);a.ExcessQOH=parseFloat(D).toFixed(2)}else{a.ExcessQOH="0"}}var _=this.getView().byId("idDatePicker").getValue().toUpperCase();var p=_.slice(6,10);var O=_.slice(0,2);var u=p;var v=O;v=parseFloat(v);var m=r.MatStock[s].CreationDate.getFullYear();var C=r.MatStock[s].CreationDate.getMonth();e=(u-m)*12+(v-C);if(e<=24){a.Months_Usage_Life_in_months=e}else{a.Months_Usage_Life_in_months="0"}if(a.CrossPlantStatus==="05"||a.MonthUsage24==="0"){a.NEW_OBS_EXC_or_GOOD="OBS"}if(a.On_Hand_Qty<=a.MonthUsage24){a.NEW_OBS_EXC_or_GOOD="GOOD"}if((a.CrossPlantStatus==="02"||a.CrossPlantStatus==="03"||a.CrossPlantStatus==="04")&&a.On_Hand_Qty>a.MonthUsage24){a.NEW_OBS_EXC_or_GOOD="EXC"}if(e<"12"){a.NEW_OBS_EXC_or_GOOD="NEW"}if(a.NEW_OBS_EXC_or_GOOD==="EXC"){a.Excess_OH_FIFO=a.ExcessQOH*a.Std_Price;a.Excess_OH_FIFO=parseFloat(a.Excess_OH_FIFO).toFixed(2)}else{a.Excess_OH_FIFO="0"}if(a.NEW_OBS_EXC_or_GOOD==="OBS"){a.Obsolete_OH_FIFO=a.ExcessQOH*a.Std_Price;a.Obsolete_OH_FIFO=parseFloat(a.Obsolete_OH_FIFO).toFixed(2)}else{a.Obsolete_OH_FIFO="0"}a.E_O_OH_FIFO=a.Excess_OH_FIFO+a.Obsolete_OH_FIFO;a.E_O_OH_FIFO=parseFloat(a.E_O_OH_FIFO).toFixed(2);if(a.E_O_OH_FIFO==="undefined"||a.E_O_OH_FIFO===""){a.E_O_OH_FIFO="0"}if(a.Tot_Std_Cost==="undefined"||a.Tot_Std_Cost===""){a.Tot_Std_Cost="0"}if(a.Std_Price==="undefined"||a.Std_Price===""){a.Std_Price="0"}if(a.GoodsShipped==="undefined"||a.GoodsShipped===""){a.GoodsShipped="0"}if(a.Consumption==="undefined"||a.Consumption===""){a.Consumption="0"}if(a.MonthUsage24==="undefined"||a.MonthUsage24===""){a.MonthUsage24="0"}if(a.Months_Usage_Life_in_months==="undefined"||a.Months_Usage_Life_in_months===""){a.Months_Usage_Life_in_months="0"}if(a.ExcessQOH==="undefined"||a.ExcessQOH===""){a.ExcessQOH="0"}if(a.NEW_OBS_EXC_or_GOOD==="undefined"||a.NEW_OBS_EXC_or_GOOD===""){a.NEW_OBS_EXC_or_GOOD="0"}if(a.Excess_OH_FIFO==="undefined"||a.Excess_OH_FIFO===""){a.Excess_OH_FIFO="0"}if(a.Obsolete_OH_FIFO==="undefined"||a.Obsolete_OH_FIFO===""){a.Obsolete_OH_FIFO="0"}o.push(a);a={}}}}c.BotList=o;var g={items:[]};g.items=o;var G=new sap.ui.model.json.JSONModel;G.setData(g);var h=sap.ui.getCore().byId("container-mat_consumption---Home--idTable3");h.setModel(G);h.setVisible(true)},onSearch:function(){var t=this;var e=this.getView().byId("idFieldPlant").getValue().toUpperCase();var a=this.getView().byId("idDatePicker").getValue().toUpperCase();if(e===""){sap.m.MessageToast.show("Please provide Plant value!!! ")}if(a===""){sap.m.MessageToast.show("Please provide End Date value!!! ")}if(e!==""&&a!==""){sap.ui.core.BusyIndicator.show();var o={items:[],Material:[],MatStock:[],StdPrice:[],GOODS_MVMT:[],GOODS_MVMT_CUM:[],Goods_MvntQty:[],SL099_QUANTITY:[],QOH:[]};var e=this.getView().byId("idFieldPlant").getValue().toUpperCase();var a=this.getView().byId("idDatePicker").getValue().toUpperCase();var n=this.getView().byId("idDatePicker").getValue().toUpperCase();var r=n.slice(6,10);var i=n.slice(0,2);var s=n.slice(3,5);var a=r+"-"+i+"-"+s;var l;var d;var _;var d;var M;var p=new Promise(function(a,o){t._getMatStock(e,a,o)});p.then(function(a){o.MatStock=a;l=new Promise(function(a,o){t._getStd_Price(e,a,o);t._getQOH(e,a,o)});l.then(function(a){o.StdPrice=a;d=new Promise(function(a,o){t._getSL099_QUANTITY(e,a,o)});d.then(function(a){_=new Promise(function(n,r){o.SL099_QUANTITY=a;t._getGoods_Mvnt(e,n,r)});_.then(function(a){M=new Promise(function(n,r){o.GOODS_MVMT=a;t._getGoods_MvntQty(e,n,r)});M.then(function(e){o.GOODS_MVMT_CUM=e;t._buildFinalData(o);sap.ui.core.BusyIndicator.hide()},function(){})},function(){})},function(){},function(){})},function(){})},function(){})}},onDataExport:function(t){var e=new sap.ui.model.json.JSONModel;e.setData(c.BotList);var a=new O({exportType:new sap.ui.core.util.ExportTypeCSV({separatorChar:",",charset:"utf-8"}),models:e,rows:{path:"/"},columns:[{name:"Material",template:{content:"'{Material}"}},{name:"Product Description",template:{content:"{ProductDescription}"}},{name:"Plant",template:{content:"{Plant}"}},{name:"Cross Plant Status",template:{content:"'{CrossPlantStatus}"}},{name:"On Hand Qty",template:{content:"{On_Hand_Qty}"}},{name:"Total Std Cost",template:{content:"{Tot_Std_Cost}"}},{name:"Std Price",template:{content:"{Std_Price}"}},{name:"Goods Shipped",template:{content:"{GoodsShipped}"}},{name:"Consumption",template:{content:"{Consumption}"}},{name:"S.Loc S099 Qty",template:{content:"{SLoc_S099_Qty}"}},{name:"24 Month Usage",template:{content:"{MonthUsage24}"}},{name:"Quantity to Reserve",template:{content:"{ExcessQOH}"}},{name:"NEW, OBS, EXC or GOOD",template:{content:"{NEW_OBS_EXC_or_GOOD}"}},{name:"Excess OH FIFO",template:{content:"{Excess_OH_FIFO}"}},{name:"Obsolete OH FIFO",template:{content:"{Obsolete_OH_FIFO}"}},{name:"E_O_OH_FIFO",template:{content:"{E_O_OH_FIFO}"}},{name:"Months Usage Life in months",template:{content:"{Months_Usage_Life_in_months}"}},{name:"Creation Date",template:{content:"{CreationDate}"}}]});a.saveFile().always(function(){this.destroy()})}})});